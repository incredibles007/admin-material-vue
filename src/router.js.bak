import Vue from "vue";
import Router from "vue-router";
import NProgress from 'nprogress';
import 'nprogress/nprogress.css';

Vue.use(Router);
const router =  new Router({
  base: '/',
  mode: 'hash',
  linkActiveClass: 'active',
  routes: [
    {
      path: '*',
      meta: {
        public: true,
      },
      redirect: {
        path: '/404'
      }
    },      
    {
      path: '/404',
      meta: {
        public: true,
      },
      name: 'NotFound',
      component: () =>  import(/* webpackChunkName: "NotFound" */ "./views/NotFound.vue")
    },    
    {
      path: '/403',
      meta: {
        public: true,
      },
      name: 'AccessDenied',
      component: () =>  import(/* webpackChunkName: "Deny" */ "./views/Deny.vue")
    },    
    {
      path: '/500',
      meta: {
        public: true,
      },
      name: 'ServerError',
      component: () =>  import(/* webpackChunkName: "ServerError" */ "./views/Error.vue")
    },  
    {
      path: '/login',
      meta: {
        public: true,
      },
      name: 'Login',
      component: () =>  import(/* webpackChunkName: "Login" */ `./views/Login.vue`)
    },      
    {
      path: '/',
      meta: { },
      name: 'Root',
      redirect: {
        name: 'Dashboard'
      }
    },    
    {
      path: "/dashboard",
      name: "dashboard",
      component: () =>  import(/* webpackChunkName: "Dashboard" */ "./views/Dashboard.vue")
    },
    {
      path: '/media',
      meta: { },
      name: 'Media',
      props: (route) => ({ type: route.query.type }),
      component: () =>  import(/* webpackChunkName: "Dashboard" */ "./views/Media.vue")
    },      
    {
      path: '/chat',
      meta: {
        public: true,
      },
      name: 'Chat',
      component: () => import( /* webpackChunkName: "routes" */ `@/components/chat/ChatLayout.vue` ),
      redirect: {
        path: '/chat/messaging'
      },
      children: [
        {
          path: '/chat/messaging/:uuid?',
          meta: {
            public: true,
          },
          name: 'ChatMessaging',
          props: true,
          components: {
            default: () => import(  /* webpackChunkName: "routes" */  `@/components/chat/ChatMessaging.vue` ),  
          }   
        },
        {
          path: '/chat/contact/:uuid?',
          meta: {
            public: true,
          },
          name: 'ChatContact',
          components: {
            default: () => import( /* webpackChunkName: "routes" */   `@/components/chat/ChatContact.vue` ),  
          }     
        }             
      ]
    },  
    {
      path: '/mail',
      meta: {
        public: true,
      },
      name: 'Mail',
      component: () => import(
        /* webpackChunkName: "routes" */
        `@/components/email/Layout.vue`
      ),
      redirect: {
        path: '/mail/all'
      },
      children: [
        {
          path: '/mail/:mailType',
          meta: {
            public: true,
          },
          name: 'MailIndex',
          component: () => import(
            /* webpackChunkName: "routes" */
            `@/components/email/List.vue`
          ),        
        },
        {
          path: '/mail/0/:uuid',
          meta: {
            public: true,
          },
          name: 'MailDetail',
          component: () => import(
            /* webpackChunkName: "routes" */
            `@/components/email/Reply.vue`
          ),        
        }      
      ]
    },          
  ]
});

// router gards
router.beforeEach((to, from, next) => {
  NProgress.start();
  next();
});

router.afterEach((to, from) => {
  NProgress.done();
});


export default router;